import{aB as ge,r as C,aJ as fe,j as e,d as he,I as P,A as D,T as s,B as Ne,b as ee,P as n,u as ye,a as de,a9 as we,a7 as O,aK as Se,ay as Ce}from"./index-e2557835.js";import{E as pe}from"./EditId-3a4900d9.js";import{c as ke,d as Ie,e as qe,f as Re}from"./Mutations-d3a4afe0.js";import{f as Te,C as Fe,g as Pe}from"./CustomModalMessages-21d53744.js";import{D as Me,C as Z,c as xe}from"./FormatChnager-3630efc0.js";import{N as Be}from"./NavIconsDualtonned-629598de.js";import{g as We}from"./Services-823bb078.js";import{C as je}from"./Container-19e483a1.js";import{D as Le,a as Ae,d as se}from"./dayjs.min-6085eb1e.js";import{G as x}from"./Grid-f905a886.js";import{C as Q}from"./Card-6c6ce8af.js";import{T as Ke,a as u}from"./TableRow-cd1bf836.js";import{C as Ee}from"./KeyboardArrowRight-ffd3b3e1.js";import{c as Ue,a as Y,e as me,b as ae}from"./index.esm-ebced901.js";import{u as $e,d as Ge,R as z,f as ue,g as te}from"./TagsInput-6b6695f6.js";import{o as _e}from"./yup-08e917aa.js";import{C as b}from"./CustomGrid-a5eaf6b9.js";import{A as He}from"./RHFAvtarUpload-e3dcd148.js";import{M as le}from"./RHFMultiFileUpload-006d2ba5.js";import{C as Ve}from"./CustomSubmitButton-a5ee7712.js";import{I as re}from"./numeral-d348d23e.js";function Oe(m){return ge({queryKey:["getEvent",m],queryFn:g=>We(g)})}function ve({open:m,onClose:g,userDetails:a}){var k,B,W;const N=Be(),[l,r]=C.useState(Array(a.bookings.length).fill(!1)),M=t=>{const h=[...l];h[t]=!h[t],r(h)},f=fe(a==null?void 0:a.id);return Oe(),console.log(a),e.jsx(je,{children:e.jsxs(Le,{maxWidth:"lg",fullWidth:!0,open:m,onClose:g,children:[e.jsx(Me,{className:"bg-[#59c5b9] text-white  rounded",children:"Car Detailed view"}),e.jsx(he,{"aria-label":"close",onClick:g,sx:{position:"absolute",right:10,top:5,color:"white"},children:e.jsx(P,{icon:"fa:close",width:"96",height:"96"})}),e.jsxs(Ae,{className:"",children:[e.jsxs(x,{container:!0,spacing:2,children:[e.jsx(x,{item:!0,xs:12,md:9,children:e.jsx(Q,{className:"p-3 shadow-xl border border-black border-dotted border-opacity-20",children:e.jsxs(x,{container:!0,spacing:3,sx:{height:{xs:"auto",md:180}},children:[e.jsx(x,{className:"flex justify-center items-center",item:!0,xs:12,md:3,children:e.jsx(D,{variant:"square",style:{width:"140px",height:"110px",cursor:"pointer"},src:a==null?void 0:a.carImage})}),e.jsx(x,{item:!0,xs:12,md:5,justify:"center",alignItems:"center",className:"border-r border-dotted text-center md:text-left",children:e.jsxs("div",{className:"flex flex-col justify-around h-full",children:[e.jsxs(s,{className:"text-2xl ",variant:"overline",children:[" ",e.jsxs("span",{className:"text-xl",children:[" ",a==null?void 0:a.name]})]}),e.jsxs(s,{className:"text-2xl mt-2",variant:"overline",children:["Company: ",a==null?void 0:a.company]}),e.jsxs(s,{className:"text-lg mt-2",variant:"subtitle1",children:["Fuel :",a==null?void 0:a.fuel]}),e.jsxs(s,{className:"text-lg mt-2",variant:"subtitle1",children:[a==null?void 0:a.vehicleNumber," | Year :",a==null?void 0:a.year]}),e.jsxs(s,{className:"text-lg mt-2",variant:"subtitle1",children:["Transmission :",a==null?void 0:a.transmission]})]})}),e.jsx(x,{item:!0,xs:12,md:4,justify:"center",alignItems:"center",children:e.jsxs("div",{className:"flex flex-col justify-around h-full",children:[e.jsx(s,{style:{letterSpacing:"3px"},className:"text-lg uppercase ",variant:"",children:"Service details"}),e.jsxs(s,{className:"text-2xl mt-2",variant:"overline",children:["Insurance - ",Z(a==null?void 0:a.insurance)]}),e.jsxs(s,{className:"text-lg mt-2",variant:"subtitle1",children:["last Service - ",Z(a==null?void 0:a.lastService)]}),e.jsxs(s,{className:"text-lg mt-2",variant:"subtitle1",children:["Service on : ",a==null?void 0:a.service_interval,","]})]})})]})})}),e.jsx(x,{item:!0,xs:12,md:3,sx:{height:{xs:"auto",md:180}},children:e.jsx(Q,{style:{backgroundImage:'url("https://t3.ftcdn.net/jpg/03/22/30/46/240_F_322304683_7ysRarFkmy2osfPKTOYQv7qTPofKelfb.jpg")'},className:"pt-2 shadow-xl bg-cover",children:e.jsx(x,{container:!0,sx:{height:170},children:e.jsxs("div",{className:"flex flex-col justify-around h-full w-full text-center",children:[e.jsx(s,{className:"text-2xl font-extrabold text-white",variant:"overline",children:e.jsx("span",{className:"text-xl",children:"Revenue Generated"})}),e.jsx(s,{className:"text-2xl mt-2 text-white",variant:"overline",children:e.jsxs("span",{className:"text-2xl",children:["₹ ",Te((f==null?void 0:f.data)||0)]})}),e.jsxs(s,{variant:"body2",className:"text-2xl    -full font-extrabold text-white text-left px-3",children:[e.jsx("span",{className:"text-",children:"Kms covered"}),e.jsx("br",{}),e.jsx("span",{className:"text-",children:(a==null?void 0:a.totalKmCovered)||0})]})]})})})})]}),e.jsx("div",{className:"mt-5",children:e.jsxs("div",{children:[e.jsx(s,{style:{letterSpacing:"2px"},className:"text-2xl",variant:"overline",children:e.jsx("span",{className:"text-xl",children:"Bookings Made"})}),e.jsxs("p",{className:"text-gray-400  mb-1",children:["Total (",(k=a.bookings)==null?void 0:k.length,")"]})]})}),e.jsx(x,{container:!0,children:((B=a==null?void 0:a.bookings)==null?void 0:B.length)>0?e.jsx(x,{item:!0,xs:12,md:12,children:(W=a==null?void 0:a.bookings)==null?void 0:W.map((t,h)=>{var y,w,p,S,I,q,R,L,A,K,T,v,G,_,H,V,E,U,F,c,o,d;return e.jsx("div",{children:e.jsxs(Q,{className:"p-3 shadow-xl border border-black border-dotted border-opacity-20 mb-4",children:[e.jsxs(x,{container:!0,sx:{height:{xs:"auto",md:180}},children:[e.jsx(x,{item:!0,xs:12,md:5,justify:"center",alignItems:"center",className:"border-r border-dotted text-center px-4 md:text-left",children:e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsxs(s,{className:"text-xl  text-gray-400",variant:"overline",children:["booking no #",h+1]})," ",e.jsxs("div",{className:" flex justify-center items-center gap-2  rounded-xl",children:[e.jsxs("div",{className:"max-w-[200px] break-words ",children:[e.jsx("p",{className:"text-gray-500",children:"From"}),e.jsx("p",{className:"text-xl max-h-[50px] max-w-[150px] overflow-hidden",children:t.pickupPoint})]}),e.jsx("div",{className:"border-b border-dotted border-[#59c5b9]  flex-1  justify-center h-7",children:e.jsx(Ne,{component:"span",sx:{width:10,height:10,mr:1},children:(y=N[7])==null?void 0:y.icon})}),e.jsxs("div",{className:"max-w-[200px] break-words ",children:[e.jsx("p",{className:"text-gray-500",children:"To"}),e.jsx("p",{className:"text-xl max-h-[50px] max-w-[150px] overflow-hidden",children:t.dropPoint})]})]}),e.jsxs("div",{className:" justify-center items-center",children:[e.jsx("p",{className:"text-gray-400 mt-5 mb-1",children:"Duration of rent"}),e.jsxs("div",{className:"flex justify-center items-center mt-2",children:[e.jsxs(s,{className:"text-xl",variant:"overline",children:[" ",e.jsxs("span",{className:"text-lg",children:["[",t.fromDate,"] "]})]}),e.jsxs(s,{className:"text-xl",variant:"overline",children:[" ",e.jsxs("span",{className:"text-lg",children:[" - [",t.toDate,"]"]})]})," "]})]})," "]})}),e.jsxs(x,{className:"border-r border-dotted text-center md:text-left",item:!0,xs:12,md:3,justify:"center",alignItems:"center",children:[e.jsxs("div",{className:"flex flex-col justify-around h-full items-center",children:[e.jsx(s,{style:{letterSpacing:"3px"},className:"text-lg uppercase ",variant:"",children:"customer selected"}),e.jsxs("div",{className:"grid grid-cols-2 gap-5 p-3 w-full",children:[e.jsx(s,{className:"text-2xl mt-2",variant:"overline",children:(w=t.customerSelected)==null?void 0:w.name}),e.jsx(s,{className:"text mt-2",variant:"caption",children:e.jsx("p",{className:"text-sm",style:{wordWrap:"break-word"},children:(p=t.customerSelected)==null?void 0:p.email})}),e.jsxs(s,{className:"text-2xl mt-2",variant:"overline",children:["pincode :",e.jsx("br",{}),(S=t.customerSelected)==null?void 0:S.pincode]}),e.jsx(s,{className:"text-2xl mt-2 flex justify-center items-center",variant:"overline",children:(I=t.customerSelected)==null?void 0:I.contactNumber})]})]})," "]}),e.jsxs(x,{className:"border-r border-dotted text-center md:text-left",item:!0,xs:12,md:3,justify:"center",alignItems:"center",children:[e.jsxs("div",{className:"flex flex-col justify-around h-full items-center",children:[e.jsx(s,{style:{letterSpacing:"3px"},className:"text-lg uppercase ",variant:"",children:"Booking made by"}),e.jsxs("div",{className:"grid grid-cols-2 gap-5 p-3 w-full",children:[e.jsx(s,{className:"text-2xl mt-2",variant:"overline",children:(q=t.employee)==null?void 0:q.name}),e.jsx(s,{className:"text mt-2",variant:"caption",children:e.jsx("p",{className:"text-sm",style:{wordWrap:"break-word"},children:(R=t.employee)==null?void 0:R.email})}),e.jsxs(s,{className:"text-2xl mt-2",variant:"overline",children:["role :",e.jsx("br",{}),(L=t.employee)==null?void 0:L.role]}),e.jsxs(s,{className:"text-2xl mt-2 flex justify-center items-center",variant:"overline",children:["Is blocked :",e.jsx("br",{}),(A=t.employee)!=null&&A.isBlocked?"yes":"no"]})]})]})," "]}),e.jsxs(x,{minHeight:40,borderRadius:1,bgcolor:"#59c5b9",item:!0,xs:12,md:1,justify:"center",alignItems:"center",children:[e.jsx(s,{onClick:()=>M(h),className:"text-2xl mt-2 flex justify-center cursor-pointer items-center h-full",variant:"overline",children:l[h]?"Show Less":"Show More"})," "]})]}),l[h]&&e.jsxs(e.Fragment,{children:[e.jsxs(x,{className:"px-4 pt-2 border-t border-dotted border-gray-400",item:!0,xs:12,md:12,children:[e.jsx(s,{style:{letterSpacing:"3px"},className:"text-lg uppercase mb-5 ",variant:"",children:"Booking details"}),e.jsxs("div",{className:"grid md:grid-cols-3 mt-2 space-y-2",children:[e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["From date : ",e.jsx("span",{className:"text-lg",children:t.fromDate})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["To date : ",e.jsx("span",{className:"text-lg",children:t.fromDate})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Total amount : ",e.jsxs("span",{className:"text-lg",children:["₹",t.total]})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Discount given : ",e.jsxs("span",{className:"text-lg",children:["₹",t.discount]})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Tax : ",e.jsxs("span",{className:"text-lg",children:["₹",t.tax]})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Booking status : ",e.jsx("span",{className:"text-lg",children:t.status})]})]})]}),e.jsx(x,{className:"px-4 pt-4 pb-3",item:!0,xs:12,md:12,children:t.driver&&e.jsxs(e.Fragment,{children:[e.jsx(s,{className:"text-lg uppercase mb-5 underline",variant:"",children:"Driver Details"}),e.jsx("br",{}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs(s,{variant:"subtitle1 mb-4",children:["Name: ",(K=t==null?void 0:t.driver)==null?void 0:K.driverName]}),e.jsxs(s,{variant:"subtitle1",children:["Contact-: ",(T=t==null?void 0:t.driver)==null?void 0:T.contactNumber]})]})]})}),e.jsxs(x,{className:"px-4 pt-2 pb-3",item:!0,xs:12,md:12,children:[e.jsx(s,{className:"text-lg uppercase mb-5 underline",variant:"",children:"Invoice items"}),e.jsxs("div",{className:"flex flex-col border",children:[e.jsxs("div",{className:"flex bg-gray-400",children:[e.jsx("p",{className:"w-[300px] border-r px-2 py-1 font-semibold",children:"Item"}),e.jsx("p",{className:"w-[300px] px-2 py-1 font-semibold",children:"Amount"})]}),t.invoiceDetails.map((j,i)=>e.jsxs("div",{className:"flex even:bg-gray-500",children:[e.jsx("p",{style:{wordWrap:"break-word"},className:"w-[300px] border-r px-2 py-1",children:j.name}),e.jsxs("p",{className:"w-[300px] px-2 py-1",children:["₹ ",j.amount]})]},i)),e.jsxs("div",{className:"flex bg-gray-500",children:[e.jsx("p",{style:{wordWrap:"break-word"},className:"w-[300px] border-r px-2 py-1 font-semibold",children:"Subtotal"}),e.jsxs("p",{className:"w-[300px] px-2 py-1",children:["₹ ",t.subTotals]})]}),e.jsxs("div",{className:"flex even:bg-gray-500",children:[e.jsx("p",{style:{wordWrap:"break-word"},className:"w-[300px] border-r px-2 py-1 font-semibold",children:"Advance"}),e.jsxs("p",{className:"w-[300px] px-2 py-1",children:["₹ -",t.advanceAmount]})]}),e.jsxs("div",{className:"flex bg-gray-400",children:[e.jsx("p",{style:{wordWrap:"break-word"},className:"w-[300px] border-r px-2 py-1 font-semibold",children:"Total"}),e.jsxs("p",{className:"w-[300px] px-2 py-1",children:["₹ ",t.total]})]})]})]}),t.isKilometreUpdated&&e.jsxs(x,{className:"px-4 pt-2 pb-3 flex gap-2 ",item:!0,xs:12,md:12,children:[e.jsx(s,{Z:!0,className:"text-lg uppercase mb-5 underline",variant:"",children:"Distance covered by car in this trip -"}),e.jsxs(s,{Z:!0,className:"text-lg uppercase mb-5 ",variant:"",children:["[ ",t.kilometreCovered," kms ]"]})]}),e.jsxs(x,{className:"px-4 pt-2 border-t border-dotted border-gray-400",item:!0,xs:12,md:12,children:[e.jsx(s,{style:{letterSpacing:"3px"},className:"text-lg uppercase mb-5 ",variant:"",children:"Customer details"}),e.jsx(D,{className:"md:mx-auto",style:{width:"110px",height:"110px",cursor:"pointer"},src:(G=(v=t.customerSelected)==null?void 0:v.customerImage)==null?void 0:G.url}),e.jsxs("div",{className:"grid md:grid-cols-3 mt-2 space-y-2 pb-4",children:[e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Name: ",e.jsx("span",{className:"text-lg",children:t.customerSelected.name})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Contact Number :"," ",e.jsx("span",{className:"text-lg",children:t.customerSelected.contactNumber})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Email : ",e.jsx("span",{className:"text-lg",children:t.customerSelected.email})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Passport Number :"," ",e.jsx("span",{className:"text-lg",children:t.customerSelected.passportNumber})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Pincode :"," ",e.jsx("span",{className:"text-lg",children:t.customerSelected.pincode})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["State : ",e.jsx("span",{className:"text-lg",children:t.customerSelected.state})]}),e.jsxs(s,{style:{maxWidth:"full",wordWrap:"break-word"},className:"text-2xl",variant:"subtitle2",children:["Address :"," ",e.jsx("span",{className:"text-lg",children:t.customerSelected.address})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Locality :"," ",e.jsx("span",{className:"text-lg",children:t.customerSelected.locality})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["City/District :"," ",e.jsx("span",{className:"text-lg",children:t.customerSelected.cityOrDistrict})]})]})]}),e.jsxs(x,{className:"px-4 pt-2 border-t border-dotted border-gray-400",item:!0,xs:12,md:12,children:[e.jsx(s,{style:{letterSpacing:"3px"},className:"text-lg uppercase mb-5 ",variant:"",children:"Booking made By details"}),e.jsx(D,{className:"md:mx-auto",style:{width:"110px",height:"110px",cursor:"pointer"},src:(H=(_=t.employee)==null?void 0:_.employeeImage)==null?void 0:H.url}),e.jsxs("div",{className:"grid md:grid-cols-3 mt-2 space-y-2 pb-4",children:[e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Name:",e.jsx("span",{className:"text-lg",children:(V=t.employee)==null?void 0:V.name})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Email :",e.jsx("span",{className:"text-lg",children:(E=t.employee)==null?void 0:E.email})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["username : ",e.jsx("span",{className:"text-lg",children:(U=t.employee)==null?void 0:U.userName})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Role : ",e.jsx("span",{className:"text-lg",children:(F=t.employee)==null?void 0:F.role})]}),e.jsxs(s,{className:"text-2xl",variant:"subtitle2",children:["Blocked :"," ",e.jsx("span",{className:"text-lg",children:(c=t.employee)!=null&&c.isBlocked?"yes":"no"})]}),e.jsxs(s,{className:"text-2xl ",variant:"subtitle2",children:["Access Given :",(d=(o=t.employee)==null?void 0:o.access)==null?void 0:d.map(j=>e.jsx("span",{className:"text-md border-r pr-1 pl-1",children:j.title}))]})]})]}),e.jsxs(s,{onClick:()=>M(h),className:"text-xl flex gap-2 cursor-pointer pt-4 justify-center items-center w-full  text-gray-400",variant:"overline",children:[e.jsxs("span",{children:["end-booking no #",h+1]}),e.jsx("span",{children:l[h]?"Show Less":"Show More"})]})]})]})},h)})}):e.jsx(Q,{className:"p-3 shadow-xl border border-black border-dotted border-opacity-20 mb-4",children:"No bookings found"})})]}),e.jsxs("div",{className:"flex justify-between p-5 px-7",children:[e.jsx("div",{children:e.jsx(ee,{color:"secondary"})}),e.jsxs("div",{children:[e.jsx(ee,{color:"primary"}),e.jsx(ee,{onClick:g,color:"primary",children:"Close"})]})]})]})})}ve.propTypes={open:n.bool.isRequired,onClose:n.func.isRequired,userDetails:n.shape({name:n.string.isRequired,email:n.string.isRequired,role:n.string.isRequired,bookings:n.array.isRequired,employeeImage:n.string,access:n.arrayOf(n.shape({value:n.string.isRequired})).isRequired}).isRequired};function Ye({id:m,selected:g,filterOption:a,name:N,serviceKilometre:l,bookings:r,transmission:M,service_interval:f,pollution:k,company:B,totalKmCovered:W,fuel:t,year:h,insurance:y,vehicleNumber:w,lastService:p,carImage:S,insurancePolicy:I,pollutionCertificate:q,rcBook:R,handleClick:L}){console.log(k);const A=ke(),K=Ie(),[T,v]=C.useState(null),G=ye(),_=i=>{v(i.currentTarget)},H=i=>{pe.setState({id:i}),console.log(i),G.push(Se),v(null)},V=()=>{v(null)},E=i=>{A.mutate(i),v(null)},[U,F]=C.useState(!1),c=()=>{F(!0)},o=()=>{const i=document.createElement("a");i.href=`${I.replace("/upload/","/upload/fl_attachment:insurance/")}`,i.download="insurance.jpg",i.click()},d=()=>{const i=document.createElement("a");i.href=`${q.replace("/upload/","/upload/fl_attachment:pollution/")}`,i.download="pollution.jpg",i.click()},j=()=>{const i=document.createElement("a");i.href=`${R.replace("/upload/","/upload/fl_attachment:rc/")}`,i.download="rc.jpg",i.click()};return e.jsxs(e.Fragment,{children:[e.jsxs(Ke,{hover:!0,tabIndex:-1,role:"checkbox",selected:g,children:[e.jsx(u,{padding:"checkbox",children:e.jsx(Ee,{disableRipple:!0,checked:g,onChange:L})}),e.jsx(u,{component:"th",scope:"row",padding:"none",children:e.jsxs(de,{alignItems:"left",marginLeft:2,direction:"column",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("div",{children:e.jsx(D,{sx:{width:70},variant:"square",alt:N,src:S||""})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(s,{className:"",variant:"overline",noWrap:!0,children:N}),e.jsxs(s,{color:"gray",variant:"overline",noWrap:!0,children:[B," "]})," ",e.jsxs(s,{color:"gray ",variant:"overline",noWrap:!0,children:["year: ",h]})]})]}),e.jsx(s,{color:"",variant:"",noWrap:!0})]})}),e.jsx(u,{children:e.jsxs(s,{variant:"overline",noWrap:!0,children:[w," "]})}),a!="servicedue"&&e.jsx(u,{component:"th",scope:"row",padding:"none",children:e.jsxs(de,{alignItems:"left",marginLeft:2,direction:"column",children:[e.jsx(s,{variant:"subtitle1",noWrap:!0,children:M}),e.jsxs(s,{color:"gray ",variant:"overline",noWrap:!0,children:["fuel: ",t]})]})}),a==="all"||a==="servicedue"?e.jsxs(e.Fragment,{children:[a!="servicedue"&&e.jsx(u,{children:e.jsxs(s,{variant:"overline",noWrap:!0,children:[W||0," KMS"]})}),e.jsx(u,{children:e.jsxs(s,{variant:"overline",noWrap:!0,children:["Every ",f," kms"]})}),a!="servicedue"&&e.jsx(u,{children:e.jsx("div",{className:"w-full flex justify-center items-center",children:(r==null?void 0:r.length)||0})})]}):e.jsx(e.Fragment,{children:a==="onrun"?e.jsxs(e.Fragment,{children:[e.jsx(u,{children:e.jsx(s,{variant:"overline",noWrap:!0,children:r==null?void 0:r.fromDate})}),e.jsxs(u,{children:[e.jsx(s,{variant:"overline",noWrap:!0,children:r==null?void 0:r.toDate})," "]})]}):e.jsx(e.Fragment,{children:a==="onyard"&&e.jsx(u,{children:e.jsx("div",{className:"w-full flex justify-center items-center",children:(r==null?void 0:r.length)||0})})})}),a==="servicedue"&&e.jsx(u,{className:"text-center",children:e.jsxs("span",{className:" w-full flex justify-center items-center",children:[l," kms"]})}),a==="servicedue"&&e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"text-center",children:e.jsx("span",{className:"w-full flex justify-center items-center",children:l<=f?`${f-l} kms`:"Service overdue"})}),e.jsx(u,{component:"th",scope:"row",padding:"none",children:e.jsx(s,{className:"flex justify-center",variant:"subtitle2",noWrap:!0,children:e.jsx("p",{onClick:()=>K.mutate(m),className:"bg-red-100 border text-black cursor-pointer p-2",children:"Mark as done"})})})]}),a!="servicedue"&&e.jsxs(e.Fragment,{children:[e.jsx(u,{children:Z(p)}),e.jsx(u,{children:Z(y)}),e.jsx(u,{children:Z(k)})]}),a==="insurancedue"&&e.jsx(u,{children:e.jsx("div",{className:"w-full flex justify-center items-center",children:xe(y)})}),a==="pollutiondue"&&e.jsx(e.Fragment,{children:e.jsx(u,{className:"text-center",children:e.jsx("span",{className:" w-full flex justify-center items-center",children:xe(k)})})}),e.jsx(u,{align:"right",children:e.jsx(he,{onClick:_,children:e.jsx(P,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(we,{open:!!T,anchorEl:T,onClose:V,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsxs(O,{onClick:c,children:[e.jsx(P,{icon:"eva:eye-fill",sx:{mr:2}}),"view"]}),I&&e.jsxs(O,{onClick:o,children:[e.jsx(P,{icon:"ic:outline-download",sx:{mr:2}}),"Insurance"]}),q&&e.jsxs(O,{onClick:d,children:[e.jsx(P,{icon:"ic:outline-download",sx:{mr:2}}),"Pollution"]}),R&&e.jsxs(O,{onClick:j,children:[e.jsx(P,{icon:"ic:outline-download",sx:{mr:2}}),"Rc Book"]}),e.jsxs(O,{onClick:()=>H(m),children:[e.jsx(P,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit"]}),e.jsxs(O,{onClick:()=>Fe(()=>E(m),Pe,v(null),m),sx:{color:"error.main"},children:[e.jsx(P,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})]}),e.jsx(ve,{open:U,onClose:()=>(F(!1),v(null)),userDetails:{name:N,id:m,bookings:r,transmission:M,totalKmCovered:W,service_interval:f,company:B,fuel:t,vehicleNumber:w,year:h,insurance:y,lastService:p,carImage:S}})]})}Ye.propTypes={id:n.string.isRequired,selected:n.bool.isRequired,name:n.string.isRequired,bookings:n.array.isRequired,transmission:n.string.isRequired,service_interval:n.number,totalKmCovered:n.number,serviceKilometre:n.number,company:n.string.isRequired,carImage:n.string,vehicleNumber:n.string,filterOption:n.string,fuel:n.string.isRequired,year:n.string.isRequired,insurance:n.string.isRequired,lastService:n.string.isRequired,handleClick:n.func.isRequired};ze.propTypes={isEdit:n.bool.isRequired};function ze({isEdit:m}){var E,U,F;const g=pe(c=>c.id),a=qe(),N=Re(),l=Ce(g),[r,M]=C.useState(null),f=[{value:"diesel",label:"Diesel"},{value:"petrol",label:"Petrol"},{value:"electric",label:"Electric"},{value:"hybrid",label:"Hybrid"},{value:"plug-in-hybrid",label:"Plug-in Hybrid"},{value:"hydrogen-fuel-cell",label:"Hydrogen Fuel Cell"},{value:"natural-gas",label:"Natural Gas"}],k=[{value:"automatic",label:"Automatic"},{value:"manual",label:"Manual"},{value:"cvt",label:"CVT (Continuously Variable Transmission)"},{value:"dct",label:"DCT (Dual Clutch Transmission)"},{value:"amt",label:"AMT (Automated Manual Transmission)"},{value:"semiautomatic",label:"Semi-Automatic"}],B=Ue().shape({name:Y().required("Model/car name is required"),manufacturingCompany:Y().required("Manufacturing company is required"),yearOfManufacturing:Y().required("Manufacturing year is required"),vehicleNumber:Y().required("Vehicle number is required"),fuelType:Y().required("Fuel type is required"),transmission:Y().required("Transmission type is required"),serviceInterval:me().required("Service interval is required"),insurance:ae().required("Date is required"),lastService:ae().required("Date is required"),pollution:ae().required("Pollution  is required"),totalKmCovered:me().required("Kilometers covered  is required")}),W={name:"",userName:"",password:"",role:"",access:[]},t=$e({resolver:_e(B),defaultValues:W}),{handleSubmit:h,control:y,reset:w,formState:{errors:p}}=t,S=async c=>await Promise.all(c.map(async d=>{if(d.url.startsWith("blob:")){const i=await(await fetch(d.url)).blob();return new Promise((J,X)=>{const $=new FileReader;$.onloadend=()=>{J({...d,url:$.result})},$.onerror=X,$.readAsDataURL(i)})}return d}));C.useEffect(()=>{var c,o,d,j,i,J,X,$,ne,ce,ie,oe;if(l.status==="success"&&m){console.log(l.data),M(l.data);const be={_id:(c=l==null?void 0:l.data)==null?void 0:c._id,name:(o=l==null?void 0:l.data)==null?void 0:o.name,manufacturingCompany:(d=l==null?void 0:l.data)==null?void 0:d.manufacturingCompany,transmission:(j=l==null?void 0:l.data)==null?void 0:j.transmission,yearOfManufacturing:(i=l==null?void 0:l.data)==null?void 0:i.yearOfManufacturing,fuelType:(J=l==null?void 0:l.data)==null?void 0:J.fuelType,serviceInterval:(X=l==null?void 0:l.data)==null?void 0:X.serviceInterval,vehicleNumber:($=l==null?void 0:l.data)==null?void 0:$.vehicleNumber,insurance:se((ne=l==null?void 0:l.data)==null?void 0:ne.insurance),lastService:se((ce=l==null?void 0:l.data)==null?void 0:ce.lastService),pollution:se((ie=l==null?void 0:l.data)==null?void 0:ie.pollution),totalKmCovered:(oe=l==null?void 0:l.data)==null?void 0:oe.totalKmCovered};w(be)}else w({name:""}),console.log("first"),q(null),L(null),K(null)},[(l==null?void 0:l.status)==="success",w,m,r]);const[I,q]=C.useState(null),[R,L]=C.useState(null),[A,K]=C.useState(null),[T,v]=C.useState(),G=c=>{if(m){const o={...c,carImage:T||r.carImage,rcBook:I||r.rcBook,insurancePolicy:R||r.insurancePolicy,pollutionCertificate:A||r.pollutionCertificate};N.mutate(o)}else{const o={...c,rcBook:I,carImage:T,insurancePolicy:R,pollutionCertificate:A};a.mutate(o)}},_=async c=>{console.log("Updated Files:",c);const o=await S(c);console.log(o);const d=o.map(j=>j.url);q(d)},H=async c=>{console.log("Updated Files:",c);const o=await S(c);console.log(o);const d=o.map(j=>j.url);K(d)},V=async c=>{console.log("Updated Files:",c);const o=await S(c);console.log(o);const d=o.map(j=>j.url);L(d)};return e.jsx(je,{children:e.jsx(Ge,{methods:t,onSubmit:h(G),children:e.jsxs(x,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(b,{layout:[12,6],children:e.jsx(He,{variant:"square",cloudinaryLink:m&&(r==null?void 0:r.carImage),label:"Car Image",w:"380px",h:"100%",isEdit:m,accept:"image/*, application/pdf",name:"carImage",onChange:c=>{console.log(c);const o=c;console.log(o);const d=new FileReader;console.log(d),d.readAsDataURL(o),d.onloadend=()=>{console.log(d),v(d.result)}}})}),e.jsxs(x,{item:!0,xs:12,md:6,children:[e.jsx("div",{style:{marginBottom:"1.3rem"},children:e.jsx(z,{name:"name",label:"model/name"})}),e.jsx("div",{style:{marginBottom:"1.3rem"},children:e.jsx(z,{name:"manufacturingCompany",label:"Manufacturing company"})}),e.jsx("div",{children:e.jsx(z,{name:"totalKmCovered",label:"Total kilometers covered"})})]}),e.jsx(x,{item:!0,xs:12,md:6,children:e.jsx(z,{name:"yearOfManufacturing",label:"Year of manufacturing "})}),e.jsx(b,{layout:[12,6],children:e.jsx(z,{name:"vehicleNumber",label:"Vehicle number"})}),e.jsx(b,{layout:[12,6],children:e.jsx(ue,{label:"Select fuel type",name:"fuelType",control:y,errors:p,menuItems:f})}),e.jsx(b,{layout:[12,6],children:e.jsx(ue,{label:"Transmission type",name:"transmission",control:y,errors:p,menuItems:k})}),e.jsx(b,{layout:[12,6],children:e.jsx(te,{name:"insurance",label:"Insurance due date",type:"datetime-local",slotProps:{textField:{fullWidth:!0,error:p.insurance!==void 0,helperText:((E=p.insurance)==null?void 0:E.message)||""}},InputLabelProps:{shrink:!0}})}),e.jsx(b,{layout:[12,6],children:e.jsx(te,{name:"pollution",label:"Pollution due date",type:"datetime-local",slotProps:{textField:{fullWidth:!0,error:p.insurance!==void 0,helperText:((U=p.insurance)==null?void 0:U.message)||""}},InputLabelProps:{shrink:!0}})}),e.jsx(b,{layout:[12,6],children:e.jsx(te,{name:"lastService",label:"Last service on",type:"datetime-local",slotProps:{textField:{fullWidth:!0,error:p.lastService!==void 0,helperText:((F=p.lastService)==null?void 0:F.message)||""}},InputLabelProps:{shrink:!0}})}),e.jsx(b,{layout:[12,6],children:e.jsx(z,{type:"number",name:"serviceInterval",label:"Service Interval (In Kilometers)"})}),e.jsxs(b,{layout:[12,6],children:[e.jsx(re,{id:"demo-simple-select-label",children:"Rc book"}),e.jsx(le,{label:"Upload Files",name:"upload",isEdit:!m,cloudinaryLink:m&&(r==null?void 0:r.rcBook),onChange:_,errors:p})]}),e.jsxs(b,{layout:[12,6],children:[e.jsx(re,{id:"demo-simple-select-label",children:"Insurance"}),e.jsx(le,{label:"Upload Files",name:"uploadpdf",isEdit:!m,cloudinaryLink:m&&(r==null?void 0:r.insurancePolicy),onChange:V,errors:p})]}),e.jsxs(b,{layout:[12,6],children:[e.jsx(re,{id:"demo-simple-select-label",children:"Pollution"}),e.jsx(le,{label:"Upload Files",name:"pollutionCertificate",isEdit:!m,cloudinaryLink:m&&(r==null?void 0:r.pollutionCertificate),onChange:H,errors:p})]}),e.jsx(Ve,{disabled:N.isPending||a.isPending,name:N.isPending||a.isPending?"Loading":`${m?"Update":"Create"} Car`})," "]})})})}export{ze as C,Ye as a};
